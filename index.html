<!DOCTYPE html>

<html>

	<head>
	  <meta charset="utf-8">
    <title>Catch Ball</title>
    <style>
    	* { padding: 0; margin: 0; }
    	canvas { background: #333333; display: block; margin: 0 auto; }
    </style>
  </head>

	<body>
		<canvas id= "myCanvas" width= "1250" height= "600"></canvas>
    
		<script>
      var canvas = document.getElementById("myCanvas");
      var ctx = canvas.getContext("2d");   

			//valeurs pour le paddle
			var paddleHeight = 10;
			var paddleWidth = 100;
			var paddleX = (canvas.width-paddleWidth) / 2;

			//valeurs pour la balle
			var x = canvas.width/2;
			var y =0 ;
			var dx = 0;
			var dy = 2;

			//valeurs pour les boutons
			var rightPressed = false;
			var leftPressed = false;

      //autre variables
			var score = 0;
      var lives = 3;

      document.addEventListener("keydown", keyDownHandler, false);
			document.addEventListener("keyup", keyUpHandler, false);

			//construction du Paddle
			function drawPaddle() {
				ctx.beginPath();
				ctx.rect(paddleX, canvas.height-11, paddleWidth, paddleHeight);
				ctx.fillStyle = "#ffffff";
				ctx.fill();
				ctx.closePath();
			}

			//construction de la balle
			function drawBall() {
				ctx.beginPath();
				ctx.arc(x, y, 10, 0, Math.PI*2);
				ctx.fillStyle = "#ffffff";
				ctx.fill();
				ctx.closePath();
				x += dx;
				y += dy;
        //remet la balle en haut
        if (canvas.height == y) {
            y = 0 
        }
      }
      
      function changingScore() {
        if(y + dy > canvas.height-1) {
          if(x > paddleX && x < paddleX + paddleWidth) {
            score++;
          }
          else {
            lives--;
            if(!lives) {
              alert("GAME OVER");
              document.location.reload();
            }
          }
        }
      }

			//bouton enfoncé
			function keyDownHandler(e) {
				if(e.keyCode == 39 || e.keyCode == 68) {
						rightPressed = true;
				}
				else if(e.keyCode == 37 || e.keyCode == 81) {
						leftPressed = true;
				}
			}

			//bouton non enfoncé
			function keyUpHandler(e) {
				if(e.keyCode == 39 || e.keyCode == 68) {
						rightPressed = false;
				}
				else if(e.keyCode == 37 || e.keyCode == 81) {
						leftPressed = false;
				}
			}

      function drawScore() {
        ctx.font = "16px Times";
        ctx.fillStyle = "#ffffff";
        ctx.fillText("Score: " + score, 10, 20);
      }

      function drawLives() {
        ctx.font = "16px Times";
        ctx.fillStyle = "#ffffff";
        ctx.fillText("Lives: " + lives, 10, 40);
      }

			function draw() {
				ctx.clearRect(0, 0, canvas.width, canvas.height);

				drawBall();
				drawPaddle();
        drawScore();
        drawLives();
        changingScore();

				if(rightPressed && paddleX < canvas.width-paddleWidth) {
						paddleX += 7;
				}
				else if (leftPressed && paddleX > 0) {
						paddleX -= 7;
				}
      }

			setInterval(draw, 10);
  	</script>

	</body>
</html>
